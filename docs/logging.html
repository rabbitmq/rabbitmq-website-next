<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="73d8ba46-8c12-43f6-8c22-24aa21b8d93d" name="onetrust-data-domain" /><meta content="https://tags.tiqcdn.com/utag/vmware/microsites-privacy/prod/utag.js" name="microsites-utag" /><script src="https://d1fto35gcfffzn.cloudfront.net/assets/jquery-1.11.2.min.js"></script><script src="//www.vmware.com/files/templates/inc/utag_data.js"></script><script src="//tags.tiqcdn.com/utag/vmware/microsites-privacy/prod/utag.sync.js"></script><script>function OptanonWrapper() { { window.dataLayer.push({ event: 'OneTrustGroupsUpdated' }); } }</script><script src="/js/gtm.js"></script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="googlebot" content="NOODP" /><meta name="google-site-verification" content="nSYeDgyKM9mw5CWcZuD0xu7iSWXlJijAlg9rcxVOYf4" /><meta name="google-site-verification" content="6UEaC3SWhpGQvqRnSJIEm2swxXpM5Adn4dxZhFsNdw0" /><meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="viewport" name="viewport" /><link href="https://fonts.googleapis.com/css?family=Raleway:400,500,600,700" rel="stylesheet" /><link rel="stylesheet" href="/css/rabbit.css" type="text/css" /><link rel="stylesheet" href="/css/highlightjs_style.css" type="text/css" /><link rel="stylesheet" href="/css/rabbit-next.css" type="text/css" /><!--[if IE 6]>
      <link rel="stylesheet" href="/css/rabbit-ie6.css" type="text/css" />
      <![endif]--><link rel="icon" type="/image/vnd.microsoft.icon" href="/favicon.ico" /><link rel="stylesheet" href="/css/tutorial.css" type="text/css" /><script async="true" type="text/javascript" src="/js/site.js"></script><title> Logging
 â€” RabbitMQ</title></head>
  <body id="logging"><div id="outerContainer"><div class="container"><div class="rabbit-logo"><a href="/"><img src="/img/logo-rabbitmq.svg" alt="RabbitMQ" /></a></div><a class="btn menubtn" onclick="showHide()">Menu <img src="/img/carrot-down-white.svg" /></a><div class="mobilemenuicon" onclick="showHide()"><img src="/img/mobile-menu-icon.svg" /></div><div id="nav"><ul id="mainNav"><li><a href="/#features">Features</a></li><li><a href="/#getstarted">Get Started</a></li><li><a href="/#support">Support</a></li><li><a href="/#community">Community</a></li><li><a href="/documentation.html">Docs</a></li></ul></div></div><div class="nav-separator"></div><div id="innerContainer" class="container"><div id="left-content"><h1> Logging
</h1>
<h2><a id="overview" class="anchor" href="#overview">Overview</a></h2>
<p>Log files is a very important aspect of system observability,
much like <a href="monitoring.html">monitoring</a>.</p>
<p>Developers and operators should inspect logs when troubleshooting an issue or assessing the
state of the system.</p>
<p>RabbitMQ supports a number of features when it comes to logging.</p>
<p>This guide covers topics such as:</p>
<ul>
<li>Supported <a href="#log-outputs">log outputs</a>: <a href="#logging-to-a-file">file</a> and <a href="#logging-to-console">standard streams (console)</a></li>
<li><a href="#log-file-location">Log file location</a></li>
<li>Supported <a href="#log-levels">log levels</a></li>
<li>How to <a href="#debug-logging">activate debug logging</a></li>
<li>How to <a href="#log-tail">tail logs of a running node</a> without having access to the log file</li>
<li>Watching <a href="#internal-events">internal events</a></li>
<li><a href="#logged-events">Connection lifecycle events</a> logged</li>
<li><a href="#json">Logging in JSON</a></li>
<li><a href="#log-message-categories">Log categories</a></li>
<li>How to <a href="#service-logs">inspect service logs</a> on systemd-based Linux systems</li>
<li><a href="#log-rotation">Log rotation</a></li>
<li><a href="#logging-to-syslog">Logging to Syslog</a></li>
<li><a href="#log-exchange">Logging to a system topic exchange</a>, <span class="code ">amq.rabbitmq.log</span></li>
</ul>
<p>and more.</p>
<h2><a id="log-outputs" class="anchor" href="#log-outputs">Log Outputs</a></h2>
<p>RabbitMQ nodes can log to multiple outputs. <a href="#logging-to-a-file">Logging to a file</a> is
one of the most common options for RabbitMQ installations.</p>
<p><a href="#logging-to-console">Logging to standard output and error streams</a> is another popular option.
<a href="#logging-to-syslog">Syslog</a>
is a yet another one supported out of the box.</p>
<p>Different outputs can have different log levels. For example, the console output can log all
messages including debug information  while the file output can only log error and higher severity
messages.</p>
<h2><a id="default-output" class="anchor" href="#default-output">Default Log Output and Behavior</a></h2>
<p>Nodes <a href="#logging-to-a-file">log to a file</a> by default, if no outputs are explicitly configured.
If some are configured, they will be used.</p>
<p>RabbitMQ versions prior to 3.9.0 would always log to a file unless explicitly configured
not to do so. With later versions, the same behavior can be achieved by explicitly
listing a file output next to other desired log outputs, such as the standard stream one.</p>
<h2><a id="log-file-location" class="anchor" href="#log-file-location">Log File Location</a></h2>
<p>Please see the <a href="relocate.html">File and Directory Location</a> guide to find default log file location for various platforms.</p>
<p>There are two ways to configure log file location. One is the <a href="configure.html">configuration file</a>. This option is recommended.
The other is the <span class="code ">RABBITMQ_LOGS</span> environment variable. It can be useful in development environments.</p>
<p>Use <a href="management.html">RabbitMQ management UI</a> or <a href="cli.html"><span class="code ">rabbitmq-diagnostics -q log_location</span></a>
to find when a node stores its log file(s).</p>
<p>The <span class="code ">RABBITMQ_LOGS</span> variable value can be either a file path or a hyphen (<span class="code ">-</span>).
<span class="code ">RABBITMQ_LOGS=-</span> will result in all log messages being sent to standard output.
See <a href="#logging-to-console">Logging to Console (Standard Output)</a>.</p>
<p>The environment variable takes precedence over the configuration file. When in doubt, consider
overriding log file location via the config file. As a consequence of the environment variable precedence,
if the environment variable is set, the configuration key <span class="code ">log.file</span> will not have any effect.</p>
<h2><a id="configuration" class="anchor" href="#configuration">Configuration</a></h2>
<p>RabbitMQ starts logging early on node start. See the <a href="configure.html">Configuration guide</a>
for a general overview of how to configure RabbitMQ.</p>
<h3><a id="logging-to-a-file" class="anchor" href="#logging-to-a-file">Logging to a File</a></h3>
<p>Logging to a file is one of the most common options for RabbitMQ installations. In modern releases,
RabbitMQ nodes only log to a file if explicitly configured to do so using
the configuration keys listed below:</p>
<ul>
<li><span class="code ">log.file</span>: log file path or <span class="code ">false</span> to deactivate the file output. Default value is taken from the <span class="code ">RABBITMQ_LOGS</span> <a href="configure.html">environment variable or configuration file</a></li>
<li><span class="code ">log.file.level</span>: log level for the file output. Default level is <span class="code ">info</span></li>
<li><span class="code ">log.file.formatter</span>: controls log entry format, text lines or JSON</li>
<li><span class="code ">log.file.rotation.date</span>, <span class="code ">log.file.rotation.size</span>, <span class="code ">log.file.rotation.count</span> for log file rotation settings</li>
<li><span class="code ">log.file.formatter.time_format</span>: controls timestamp formatting</li>
</ul>
<p>The following example overrides log file name:</p>
<pre class="lang-ini">
log.file = rabbit.log
</pre>

<p>The following example overrides log file location:</p>
<pre class="lang-ini">
log.file = /opt/custom/var/log/rabbit.log
</pre>

<p>The following example instructs RabbitMQ to log to a file at the <span class="code ">debug</span> level:</p>
<pre class="lang-ini">
log.file.level = debug
</pre>

<p>Supported log levels ca be found in the <a href="https://github.com/rabbitmq/rabbitmq-server/blob/v3.9.x/deps/rabbit/docs/rabbitmq.conf.example">example rabbitmq.conf file</a>.</p>
<p>Logging to a file can be deactivated with</p>
<pre class="lang-ini">
log.file = false
</pre>

<p>Logging in JSON format to a file:</p>
<pre class="lang-ini">
log.file.formatter = json
</pre>

<p>By default, RabbitMQ will use RFC 3339 timestamp format. It is possible
to switch to a UNIX epoch-based format:</p>
<pre class="lang-ini">
log.file = true
log.file.level = info

# use microseconds since UNIX epoch for timestamp format
log.file.formatter.time_format = epoch_usecs
</pre>

<p>The rest of this guide describes more options, including <a href="#advanced-configuration">more advanced ones</a>.</p>
<h3><a id="log-rotation" class="anchor" href="#log-rotation">Log Rotation</a></h3>
<p>RabbitMQ nodes always append to the log files, so a complete log history is preserved.
Log file rotation is not performed by default. <a href="install-debian.html">Debian</a> and <a href="install-rpm.html">RPM</a> packages will set up
log <a href="#logrotate">rotation via <span class="code ">logrotate</span></a> after package installation.</p>
<p><span class="code ">log.file.rotation.date</span>, <span class="code ">log.file.rotation.size</span>, <span class="code ">log.file.rotation.count</span> settings control log file rotation
for the file output.</p>
<h4>Built-in Periodic Rotation</h4>
<p>Use <span class="code ">log.file.rotation.date</span> to set up minimalistic periodic rotation:</p>
<pre class="lang-ini">
# rotate every night at midnight
log.file.rotation.date = $D0

# keep up to 5 archived log files in addition to the current one
log.file.rotation.count = 5
</pre>

<pre class="lang-ini">
# rotate every day at 23:00 (11:00 p.m.)
log.file.rotation.date = $D23
</pre>

<pre class="lang-ini">
# rotate every night at midnight
log.file.rotation.date = $D0
</pre>

<h4>Built-in File Size-based Rotation</h4>
<p><span class="code ">log.file.rotation.size</span> controls rotation based on the current log file size:</p>
<pre class="lang-ini">
# rotate when the file reaches 10 MiB
log.file.rotation.size = 10485760

# keep up to 5 archived log files in addition to the current one
log.file.rotation.count = 5
</pre>

<h4><a id="logrotate" class="anchor" href="#logrotate">Rotation Using Logrotate</a></h4>
<p>On Linux, BSD and other UNIX-like systems, <a href="https://linux.die.net/man/8/logrotate">logrotate</a> is an alternative
way of log file rotation and compression.</p>
<p>RabbitMQ <a href="./install-debian.html">Debian</a> and <a href="./install-rpm.html">RPM</a> packages will set up <span class="code ">logrotate</span> to run weekly on files
located in default <span class="code ">/var/log/rabbitmq</span> directory. Rotation configuration can be found in <span class="code ">/etc/logrotate.d/rabbitmq-server</span>.</p>
<h3><a id="logging-to-console" class="anchor" href="#logging-to-console">Logging to Console (Standard Output)</a></h3>
<p>Logging to standard streams (console) is another popular option for RabbitMQ installations,
in particular when RabbitMQ nodes are deployed in containers.
RabbitMQ nodes only log to standard streams if explicitly configured to do so.</p>
<p>Here are the main settings that control console (standard output) logging:</p>
<ul>
<li><span class="code ">log.console</span> (boolean): set to <span class="code ">true</span> to activate console output. Default is `false</li>
<li><span class="code ">log.console.level</span>: log level for the console output. Default level is <span class="code ">info</span></li>
<li><span class="code ">log.console.formatter</span>: controls log entry format, text lines or JSON</li>
<li><span class="code ">log.console.formatter.time_format</span>: controls timestamp formatting</li>
</ul>
<p>To activate console logging, use the following config snippet:</p>
<pre class="lang-ini">
log.console = true
</pre>

<p>The following example deactivates console logging</p>
<pre class="lang-ini">
log.console = false
</pre>

<p>The following example instructs RabbitMQ to use the <span class="code ">debug</span> logging level when logging to console:</p>
<pre class="lang-ini">
log.console.level = debug
</pre>

<p>Supported log levels ca be found in the <a href="https://github.com/rabbitmq/rabbitmq-server/blob/v3.9.x/deps/rabbit/docs/rabbitmq.conf.example">example rabbitmq.conf file</a>.</p>
<p>Logging to console in JSON format:</p>
<pre class="lang-ini">
log.console.formatter = json
</pre>

<p>When console output is activated, the file output will also be activated by default.
To deactivate the file output, set <span class="code ">log.file</span> to <span class="code ">false</span>:</p>
<pre class="lang-ini">
log.console = true
log.console.level = info

log.file = false
</pre>

<p>By default, RabbitMQ will use RFC 3339 timestamp format. It is possible
to switch to a UNIX epoch-based format:</p>
<pre class="lang-ini">
log.console = true
log.console.level = info

log.file = false

# use microseconds since UNIX epoch for timestamp format
log.console.formatter.time_format = epoch_usecs
</pre>

<p>Please note that <span class="code ">RABBITMQ_LOGS=-</span> will deactivate the file output
even if <span class="code ">log.file</span> is configured.</p>
<h3><a id="logging-to-syslog" class="anchor" href="#logging-to-syslog">Logging to Syslog</a></h3>
<p>RabbitMQ logs can be forwarded to a Syslog server via TCP or UDP. UDP is used by default
and <strong>requires Syslog service configuration</strong>. TLS is also supported.</p>
<p>Syslog output has to be explicitly configured:</p>
<pre class="lang-ini">
log.syslog = true
</pre>

<h4>Syslog Endpoint Configuration</h4>
<p>By default the Syslog logger will send log messages to UDP port 514 using
the <a href="https://www.ietf.org/rfc/rfc3164.txt">RFC 3164</a> protocol. <a href="https://tools.ietf.org/html/rfc5424">RFC 5424</a>
protocol also can be used.</p>
<p>In order to use UDP the <strong>Syslog service must have UDP input configured</strong>.</p>
<p>UDP and TCP transports can be used with both RFC 3164 and RFC 5424 protocols.
TLS support requires the RFC 5424 protocol.</p>
<p>The following example uses TCP and the RFC 5424 protocol:</p>
<pre class="lang-ini">
log.syslog = true
log.syslog.transport = tcp
log.syslog.protocol = rfc5424
</pre>

<p>To use TLS, a standard set of <a href="ssl.html">TLS options</a> must be provided:</p>
<pre class="lang-ini">
log.syslog = true
log.syslog.transport = tls
log.syslog.protocol = rfc5424

log.syslog.ssl_options.cacertfile = /path/to/ca_certificate.pem
log.syslog.ssl_options.certfile = /path/to/client_certificate.pem
log.syslog.ssl_options.keyfile = /path/to/client_key.pem
</pre>

<p>Syslog service IP address and port can be customised:</p>
<pre class="lang-ini">
log.syslog = true
log.syslog.ip = 10.10.10.10
log.syslog.port = 1514
</pre>

<p>If a hostname is to be used rather than an IP address:</p>
<pre class="lang-ini">
log.syslog = true
log.syslog.host = my.syslog-server.local
log.syslog.port = 1514
</pre>

<p>Syslog metadata identity and facility values also can be configured.
By default identity will be set to the name part of the node name (for example, <span class="code ">rabbitmq</span> in <span class="code ">rabbitmq@hostname</span>)
and facility will be set to <span class="code ">daemon</span>.</p>
<p>To set identity and facility of log messages:</p>
<pre class="lang-ini">
log.syslog = true
log.syslog.identity = my_rabbitmq
log.syslog.facility = user
</pre>

<p>Logging to Syslog in JSON format:</p>
<pre class="lang-ini">
log.syslog = true

log.syslog.formatter = json
</pre>

<p>Less commonly used <a href="https://github.com/schlagert/syslog">Syslog client</a> options can
be configured using the <a href="./configure.html#configuration-files">advanced config file</a>.</p>
<h2><a id="json" class="anchor" href="#json">JSON Logging</a></h2>
<p>RabbitMQ nodes can format log messages as JSON, which can be convenient for parsing by other pieces of software.</p>
<p>Logging to a file in JSON format:</p>
<pre class="lang-ini">
log.file.level = info
log.file.formatter = json
</pre>

<p>Logging to the console in JSON format:</p>
<pre class="lang-ini">
log.console = true
log.console.level = info
log.console.formatter = json

log.file = false
</pre>

<p>Logging to Syslog in JSON format:</p>
<pre class="lang-ini">
log.syslog = true

log.syslog.formatter = json
</pre>

<h2><a id="log-message-categories" class="anchor" href="#log-message-categories">Log Message Categories</a></h2>
<p>RabbitMQ has several categories of messages, which can be logged with different
levels or to different files.</p>
<p>The categories replace the <span class="code ">rabbit.log_levels</span> configuration setting in versions
earlier than 3.7.0.</p>
<p>The categories are:</p>
<ul>
<li><span class="code ">connection</span>: <a href="#connection-lifecycle-events">connection lifecycle events</a> for AMQP 0-9-1, AMQP 1.0, MQTT and STOMP.</li>
<li><span class="code ">channel</span>: channel logs. Mostly errors and warnings on AMQP 0-9-1 channels.</li>
<li><span class="code ">queue</span>: queue logs. Mostly debug messages.</li>
<li><span class="code ">mirroring</span>: queue mirroring logs. Queue mirrors status changes: starting/stopping/synchronizing.</li>
<li><span class="code ">federation</span>: federation plugin logs.</li>
<li><span class="code ">upgrade</span>: verbose upgrade logs. These can be excessive.</li>
<li><span class="code ">default</span>: all other log entries. You cannot override file location for this category.</li>
</ul>
<p>It is possible to configure a different log level or file location for each message category
using <span class="code ">log.&lt;category&gt;.level</span> and <span class="code ">log.&lt;category&gt;.file</span> configuration variables.</p>
<p>By default each category will not filter by level. If an is output configured to log <span class="code ">debug</span>
messages, the debug messages will be printed for all categories. Configure a log level for a
category to override.</p>
<p>For example, given debug level in the file output,
the following will deactivate debug logging for connection events:</p>
<pre class="lang-ini">
log.file.level = debug
log.connection.level = info
</pre>

<p>To redirect all federation logs to the <span class="code ">rabbit_federation.log</span> file, use:</p>
<pre class="lang-ini">
log.federation.file = rabbit_federation.log
</pre>

<p>To deactivate a log type, you can use the <span class="code ">none</span> log level. For example, to deactivate
upgrade logs:</p>
<pre class="lang-ini">
log.upgrade.level = none
</pre>

<h3><a id="log-levels" class="anchor" href="#log-levels">Log Levels</a></h3>
<p>Log levels is another way to filter and tune logging. Log levels have
a strict ordering. Each log message has a severity from <span class="code ">debug</span> being
the lowest severity to <span class="code ">critical</span> being the highest.</p>
<p>Logging verbosity can be controlled on multiple layers by setting log
levels for categories and outputs. More verbose log levels will
include more log messages from <span class="code ">debug</span> being the most verbose to
<span class="code ">none</span> being the least.</p>
<p>The following log levels are used by RabbitMQ:</p>
<table>
<thead>
<tr>
<th>Log level</th>
<th>Verbosity</th>
<th>Severity</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="code ">debug</span></td>
<td>most verbose</td>
<td>lowest severity</td>
</tr>
<tr>
<td><span class="code ">info</span></td>
<td></td>
<td></td>
</tr>
<tr>
<td><span class="code ">warning</span></td>
<td></td>
<td></td>
</tr>
<tr>
<td><span class="code ">error</span></td>
<td></td>
<td></td>
</tr>
<tr>
<td><span class="code ">critical</span></td>
<td></td>
<td>highest severity</td>
</tr>
<tr>
<td><span class="code ">none</span></td>
<td>least verbose</td>
<td>not applicable</td>
</tr>
</tbody>
</table>
<p>Default log level is <span class="code ">info</span>.</p>
<p>If a log message has lower severity than the category level,
the message will be dropped and not sent to any output.</p>
<p>If a category level is not configured, its messages will always be sent
to all outputs.</p>
<p>To make the <span class="code ">default</span> category log only errors or higher severity messages, use</p>
<pre class="lang-ini">
log.default.level = error
</pre>

<p>The <span class="code ">none</span> level means no logging.</p>
<p>Each output can use its own log level. If a message
has lower severity than the output level, the message will not be logged.</p>
<p>For example, if no outputs are configured to log
<span class="code ">debug</span> messages, even if the category level is set to <span class="code ">debug</span>, the
debug messages will not be logged.</p>
<p>On the other hand, if an output is configured to log <span class="code ">debug</span> messages,
it will get them from all categories, unless a category is configured
with a less verbose level.</p>
<h4><a id="changing-log-level" class="anchor" href="#changing-log-level">Changing Log Level</a></h4>
<p>There are two ways of changing effective log levels:</p>
<ul>
<li>Via <a href="configure.html">configuration file(s)</a>: this is more flexible but requires
   a node restart between changes</li>
<li>Using <a href="./cli.html">CLI tools</a>, <span class="code ">rabbitmqctl set_log_level &lt;level&gt;</span>: the changes are transient (will not survive node restart) but can be used to
   activate and deactivate, for example, <a href="#debug-logging">debug logging</a> at runtime for a period of time.</li>
</ul>
<p>To set log level to <span class="code ">debug</span> on a running node:</p>
<pre class="lang-bash">
rabbitmqctl -n rabbit@target-host set_log_level debug
</pre>

<p>To set the level to <span class="code ">info</span>:</p>
<pre class="lang-bash">
rabbitmqctl -n rabbit@target-host set_log_level info
</pre>

<h2><a id="log-tail" class="anchor" href="#log-tail">Tailing Logs Using CLI Tools</a></h2>
<p>Modern releases support tailing logs of a node using <a href="./cli.html">CLI tools</a>. This is convenient
when log file location is not known or is not easily accessible but CLI tool connectivity
is allowed.</p>
<p>To tail three hundred last lines on a node <span class="code ">rabbitmq@target-host</span>, use <span class="code ">rabbitmq-diagnostics log_tail</span>:</p>
<pre class="lang-bash">
# This is semantically equivalent to using `tail -n 300 /path/to/rabbit@hostname.log`.
# Use -n to specify target node, -N is to specify the number of lines.
rabbitmq-diagnostics -n rabbit@target-host log_tail -N 300
</pre>

<p>This will load and print last lines from the log file.
If only console logging is activated, this command will fail with a "file not found" (<span class="code ">enoent</span>) error.</p>
<p>To continuously inspect as a stream of log messages as they are appended to a file,
similarly to <span class="code ">tail -f</span> or console logging, use <span class="code ">rabbitmq-diagnostics log_tail_stream</span>:</p>
<pre class="lang-bash">
# This is semantically equivalent to using `tail -f /path/to/rabbit@hostname.log`.
# Use Control-C to stop the stream.
rabbitmq-diagnostics -n rabbit@target-host log_tail_stream
</pre>

<p>This will continuously tail and stream lines added to the log file.
If only console logging is activated, this command will fail with a "file not found" (<span class="code ">enoent</span>) error.</p>
<p>The <span class="code ">rabbitmq-diagnostics log_tail_stream</span> command can only be used against a running RabbitMQ node
and will fail if the node is not running or the RabbitMQ application on it
was stopped using <span class="code ">rabbitmqctl stop_app</span>.</p>
<h2><a id="debug-logging" class="anchor" href="#debug-logging">Activating Debug Logging</a></h2>
<p>To activate debug messages, you should have a debug output.</p>
<p>For example to log debug messages to a file:</p>
<pre class="lang-ini">
log.file.level = debug
</pre>

<p>To print log messages to standard I/O streams:</p>
<pre class="lang-ini">
log.console = true
log.console.level = debug
</pre>

<p>To switch to debug logging at runtime:</p>
<pre class="lang-bash">
rabbitmqctl -n rabbit@target-host set_log_level debug
</pre>

<p>To set the level back to <span class="code ">info</span>:</p>
<pre class="lang-bash">
rabbitmqctl -n rabbit@target-host set_log_level info
</pre>

<p>It is possible to deactivate debug logging for some categories:</p>
<pre class="lang-ini">
log.file.level = debug

log.connection.level = info
log.channel.level = info
</pre>

<h2><a id="service-logs" class="anchor" href="#service-logs">Service Logs</a></h2>
<p>On <span class="code ">systemd</span>-based Linux distributions, system service logs can be
inspected using <span class="code ">journalctl --system</span></p>
<pre class="lang-bash">
journalctl --system
</pre>

<p>which requires superuser privileges.
Its output can be filtered to narrow it down to RabbitMQ-specific entries:</p>
<pre class="lang-bash">
sudo journalctl --system | grep rabbitmq
</pre>

<p>Service logs will include standard output and standard error streams of the node.
The output of <span class="code ">journalctl --system</span> will look similar to this:</p>
<pre class="lang-plaintext">
Dec 26 11:03:04 localhost rabbitmq-server[968]: ##  ##
Dec 26 11:03:04 localhost rabbitmq-server[968]: ##  ##      RabbitMQ 3.11.6. Copyright (c) 2007-2023 VMware, Inc. or its affiliates.
Dec 26 11:03:04 localhost rabbitmq-server[968]: ##########  Licensed under the MPL.  See https://www.rabbitmq.com/
Dec 26 11:03:04 localhost rabbitmq-server[968]: ######  ##
Dec 26 11:03:04 localhost rabbitmq-server[968]: ##########  Logs: /var/log/rabbitmq/rabbit@localhost.log
Dec 26 11:03:04 localhost rabbitmq-server[968]: /var/log/rabbitmq/rabbit@localhost_upgrade.log
Dec 26 11:03:04 localhost rabbitmq-server[968]: Starting broker...
Dec 26 11:03:05 localhost rabbitmq-server[968]: systemd unit for activation check: "rabbitmq-server.service"
Dec 26 11:03:06 localhost rabbitmq-server[968]: completed with 6 plugins.
</pre>

<h2><a id="logged-events" class="anchor" href="#logged-events">Logged Events</a></h2>
<h3><a id="connection-lifecycle-events" class="anchor" href="#connection-lifecycle-events">Connection Lifecycle Events</a></h3>
<p>Successful TCP connections that send at least 1 byte of data will be logged. Connections
that do not send any data, such as health checks of certain load balancer products, will
not be logged.</p>
<p>Here's an example:</p>
<pre class="lang-plaintext">
2018-11-22 10:44:33.654 [info] &lt;0.620.0&gt; accepting AMQP connection &lt;0.620.0&gt; (127.0.0.1:52771 -&gt; 127.0.0.1:5672)
</pre>

<p>The entry includes client IP address and port (<span class="code ">127.0.0.1:52771</span>) as well as the target
IP address and port of the server (<span class="code ">127.0.0.1:5672</span>). This information can be useful
when troubleshooting client connections.</p>
<p>Once a connection successfully authenticates and is granted access to a <a href="./vhosts.html">virtual host</a>,
that is also logged:</p>
<pre class="lang-plaintext">
2018-11-22 10:44:33.663 [info] &lt;0.620.0&gt; connection &lt;0.620.0&gt; (127.0.0.1:52771 -&gt; 127.0.0.1:5672): user 'guest' authenticated and granted access to vhost '/'
</pre>

<p>The examples above include two values that can be used as connection identifiers
in various scenarios: connection name (<span class="code ">127.0.0.1:57919 -&gt; 127.0.0.1:5672</span>) and an Erlang process ID of the connection (<span class="code ">&lt;0.620.0&gt;</span>).
The latter is used by <a href="./cli.html">rabbitmqctl</a> and the former is used by the <a href="./management.html">HTTP API</a>.</p>
<p>A <a href="connections.html">client connection</a> can be closed cleanly or abnormally. In the
former case the client closes AMQP 0-9-1 (or 1.0, or STOMP, or
MQTT) connection gracefully using a dedicated library function
(method). In the latter case the client closes TCP connection
or TCP connection fails. RabbitMQ will log both cases.</p>
<p>Below is an example entry for a successfully closed connection:</p>
<pre class="lang-plaintext">
2018-06-17 06:23:29.855 [info] &lt;0.634.0&gt; closing AMQP connection &lt;0.634.0&gt; (127.0.0.1:58588 -&gt; 127.0.0.1:5672, vhost: '/', user: 'guest')
</pre>

<p>Abruptly closed connections will be logged as warnings:</p>
<pre class="lang-plaintext">
2018-06-17 06:28:40.868 [warning] &lt;0.646.0&gt; closing AMQP connection &lt;0.646.0&gt; (127.0.0.1:58667 -&gt; 127.0.0.1:5672, vhost: '/', user: 'guest'):
client unexpectedly closed TCP connection
</pre>

<p>Abruptly closed connections can be harmless. For example, a short lived program can naturally stop
and don't have a chance to close its connection. They can also hint at a genuine issue such as
a failed application process or a proxy that closes TCP connections it considers to be idle.</p>
<h2><a id="upgrading" class="anchor" href="#upgrading">Upgrading From pre-3.7 Versions</a></h2>
<p>RabbitMQ versions prior to 3.7.0 had a different logging subsystem.</p>
<p>Older installations use two log files:
<span class="code ">&lt;nodename&gt;.log</span> and <span class="code ">&lt;nodename&gt;_sasl.log</span> (<span class="code ">&lt;nodename&gt;</span> is <span class="code ">rabbit@{hostname}</span> by default).</p>
<p>Where <span class="code ">&lt;nodename&gt;.log</span> contains RabbitMQ logs, while <span class="code ">&lt;nodename&gt;_sasl.log</span> contains
runtime logs, mostly unhandled exceptions.</p>
<p>Starting with 3.7.0 these two files were merged and all errors now can be found in
the <span class="code ">&lt;nodename&gt;.log</span> file. So <span class="code ">RABBITMQ_SASL_LOGS</span> environment variable is not used
anymore.</p>
<p>Log levels in versions before <span class="code ">3.7.0</span> were configured using the <span class="code ">log_levels</span> configuration key.
Starting with <span class="code ">3.7.0</span> it's been replaced with <a href="#log-message-categories">categories</a>,
which are more descriptive and powerful.</p>
<p>If the <span class="code ">log_levels</span> key is present in <span class="code ">rabbitmq.config</span> file, it should be updated to
<a href="#log-message-categories">use categories</a>.</p>
<p><span class="code ">rabbit.log_levels</span> will work in 3.7.0 <strong>only</strong> if no <span class="code ">categories</span> are defined.</p>
<h2><a id="internal-events" class="anchor" href="#internal-events">Watching Internal Events</a></h2>
<p>RabbitMQ nodes have an internal mechanism. Some of its events can be of interest for monitoring,
audit and troubleshooting purposes. They can be consumed as JSON objects using a <span class="code ">rabbitmq-diagnostics</span> command:</p>
<pre class="lang-bash">
# will emit JSON objects
rabbitmq-diagnostics consume_event_stream
</pre>

<p>When used interactively, results can be piped to a command line JSON processor such as <a href="https://stedolan.github.io/jq/">jq</a>:</p>
<pre class="lang-bash">
rabbitmq-diagnostics consume_event_stream | jq
</pre>

<p>The events can also be exposed to applications for <a href="./consumers.html">consumption</a>
with <a href="event-exchange.html">a plugin</a>.</p>
<p>Events are published as messages with blank bodies. All event metadata is stored in
message metadata (properties, headers).</p>
<p>Below is a list of published events.</p>
<h3>Core Broker</h3>
<p><a href="queues.html">Queue</a>, Exchange and Binding events:</p>
<ul>
<li><span class="code ">queue.deleted</span></li>
<li><span class="code ">queue.created</span></li>
<li><span class="code ">exchange.created</span></li>
<li><span class="code ">exchange.deleted</span></li>
<li><span class="code ">binding.created</span></li>
<li><span class="code ">binding.deleted</span></li>
</ul>
<p><a href="connections.html">Connection</a> and <a href="channels.html">Channel</a> events:</p>
<ul>
<li><span class="code ">connection.created</span></li>
<li><span class="code ">connection.closed</span></li>
<li><span class="code ">channel.created</span></li>
<li><span class="code ">channel.closed</span></li>
</ul>
<p><a href="./consumers.html">Consumer</a> events:</p>
<ul>
<li><span class="code ">consumer.created</span></li>
<li><span class="code ">consumer.deleted</span></li>
</ul>
<p><a href="./parameters.html">Policy and Parameter</a> events:</p>
<ul>
<li><span class="code ">policy.set</span></li>
<li><span class="code ">policy.cleared</span></li>
<li><span class="code ">parameter.set</span></li>
<li><span class="code ">parameter.cleared</span></li>
</ul>
<p><a href="./vhosts.html">Virtual host</a> events:</p>
<ul>
<li><span class="code ">vhost.created</span></li>
<li><span class="code ">vhost.deleted</span></li>
<li><span class="code ">vhost.limits.set</span></li>
<li><span class="code ">vhost.limits.cleared</span></li>
</ul>
<p>User management events:</p>
<ul>
<li><span class="code ">user.authentication.success</span></li>
<li><span class="code ">user.authentication.failure</span></li>
<li><span class="code ">user.created</span></li>
<li><span class="code ">user.deleted</span></li>
<li><span class="code ">user.password.changed</span></li>
<li><span class="code ">user.password.cleared</span></li>
<li><span class="code ">user.tags.set</span></li>
</ul>
<p><a href="./access-control.html">Permission</a> events:</p>
<ul>
<li><span class="code ">permission.created</span></li>
<li><span class="code ">permission.deleted</span></li>
<li><span class="code ">topic.permission.created</span></li>
<li><span class="code ">topic.permission.deleted</span></li>
</ul>
<p><a href="./alarms.html">Alarm</a> events:</p>
<ul>
<li><span class="code ">alarm.set</span></li>
<li><span class="code ">alarm.cleared</span></li>
</ul>
<h3><a href="shovel.html">Shovel Plugin</a></h3>
<p>Worker events:</p>
<ul>
<li><span class="code ">shovel.worker.status</span></li>
<li><span class="code ">shovel.worker.removed</span></li>
</ul>
<h3><a href="federation.html">Federation Plugin</a></h3>
<p>Link events:</p>
<ul>
<li><span class="code ">federation.link.status</span></li>
<li><span class="code ">federation.link.removed</span></li>
</ul>
<h2><a id="log-exchange" class="anchor" href="#log-exchange">Consuming Log Entries Using a System Log Exchange</a></h2>
<p>RabbitMQ can forward log entries to a system exchange, <span class="code ">amq.rabbitmq.log</span>, which
will be declared in the default <a href="vhosts.html">virtual host</a>.</p>
<p>This feature is deactivated by default.
To activate this logging, set the <span class="code ">log.exchange</span> configuration key to <span class="code ">true</span>:</p>
<pre class="lang-ini">
# activate log forwarding to amq.rabbitmq.log, a topic exchange
log.exchange = true
</pre>

<p><span class="code ">log.exchange.level</span> can be used to control the <a href="#log-levels">log level</a> that
will be used by this logging target:</p>
<pre class="lang-ini">
log.exchange = true
log.exchange.level = warning
</pre>

<p><span class="code ">amq.rabbitmq.log</span> is a regular topic exchange and can be used as such.
Log entries are published as messages. Message body contains the logged message
and routing key is set to the log level.</p>
<p>Application that would like to consume log entries need to declare a queue
and bind it to the exchange, using a routing key to filter a specific log level,
or <span class="code ">#</span> to consume all log entries allowed by the configured log level.</p><div id="help-and-feedback"><h2>Getting Help and Providing Feedback</h2><p>
                    If you have questions about the contents of this guide or
                    any other topic related to RabbitMQ, don't hesitate to ask them
                    on the <a href="https://groups.google.com/forum/#!forum/rabbitmq-users">RabbitMQ mailing list</a>.
                  </p></div><div id="contribute"><h2>Help Us Improve the Docs &lt;3</h2><p>
                    If you'd like to contribute an improvement to the site,
                    its source is <a href="https://github.com/rabbitmq/rabbitmq-website">available on GitHub</a>.
                    Simply fork the repository and submit a pull request. Thank you!
                  </p></div></div><div id="right-nav"><div id="in-this-section"><h4>In This Section</h4><ul>
     <li><a href="/admin-guide.html" class="selected">Server Documentation</a><ul>
       <li><a href="/configure.html" class="selected">Configuration</a><ul>
         <li><a href="/relocate.html">File Locations</a></li>
         <li><a href="/logging.html" class="selected">Logging</a></li>
         <li><a href="/persistence-conf.html">Persistence</a></li>
         <li><a href="/networking.html">Networking</a></li>
         <li><a href="/parameters.html">Parameters and Policies</a></li>
       </ul></li>
       <li><a href="/management.html">Management UI</a></li>
       <li><a href="/monitoring.html">Monitoring</a></li>
       <li><a href="/production-checklist.html">Production Checklist</a></li>
       <li><a href="/ssl.html">TLS Support</a></li>
       <li><a href="/streams.html">Streams</a></li>
       <li><a href="/feature-flags.html">Feature Flags</a></li>
       <li><a href="/distributed.html">Distributed RabbitMQ</a></li>
       <li><a href="/clustering.html">Clustering</a></li>
       <li><a href="/reliability.html">Reliable Delivery</a></li>
       <li><a href="/definitions.html">Schema Definition Export and Import</a></li>
       <li><a href="/backup.html">Backup and restore</a></li>
       <li><a href="/alarms.html">Alarms</a></li>
       <li><a href="/memory-use.html">Memory Use</a></li>
       <li><a href="/networking.html">Networking</a></li>
       <li><a href="/vhosts.html">Virtual Hosts</a></li>
       <li><a href="/access-control.html">Access Control (Authorisation)</a></li>
       <li><a href="/authentication.html">Authentication Mechanisms</a></li>
       <li><a href="/ldap.html">LDAP</a></li>
       <li><a href="/lazy-queues.html">Lazy Queues</a></li>
       <li><a href="/event-exchange.html">Internal Event Exchange</a></li>
       <li><a href="/firehose.html">Firehose (Message Tracing)</a></li>
       <li><a href="/manpages.html">Manual Pages</a></li>
       <li><a href="/windows-quirks.html">Windows Quirks</a></li>
       
       
       
       
     </ul></li>
     <li><a href="/clients.html">Client Documentation</a></li>
     <li><a href="/plugins.html">Plugins</a></li>
     <li><a href="/news.html">News</a></li>
     <li><a href="/protocol.html">Protocol</a></li>
     <li><a href="/extensions.html">Our Extensions</a></li>
     <li><a href="/build.html">Building</a></li>
     
     <li><a href="/mpl.html">License</a></li>
   </ul></div></div></div><div class="clear"></div><div class="pageFooter"><div class="container"></div><div class="container"><div class="rabbit-logo"><a href="/"><img src="/img/logo-rabbitmq-white.svg" alt="RabbitMQ" /></a></div><ul class="footerNav"><li><a href="/#features">Features</a></li><li><a href="/#getstarted">Get Started</a></li><li><a href="/#support">Support</a></li><li><a href="/#community">Community</a></li><li><a href="/documentation.html">Docs</a></li></ul><p id="copyright">
          Copyright Â© 2007-2023 <a href="https://tanzu.vmware.com/">VMware</a>, Inc. or its affiliates. All rights reserved.
          <a href="https://www.vmware.com/help/legal.html">Terms of Use</a> â€¢
          <a href="https://www.vmware.com/help/privacy.html">Privacy</a> â€¢
          <a href="/trademark-guidelines.html">Trademark Guidelines</a> â€¢
          <a href="https://www.vmware.com/help/privacy/california-privacy-rights.html">Your California Privacy Rights</a> â€¢
          <a class="ot-sdk-show-settings">Cookie Settings</a><br /><a id="teconsent"></a></p></div></div></div><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript">
        // code highlighting
        window.addEventListener("load", function() {
          const selectors = "pre.lang-apacheconf, \
                             pre.lang-bash, \
                             pre.lang-csharp, \
                             pre.lang-clojure, \
                             pre.lang-elixir, \
                             pre.lang-erlang, \
                             pre.lang-go, \
                             pre.lang-groovy, \
                             pre.lang-haskell, \
                             pre.lang-ini, \
                             pre.lang-java, \
                             pre.lang-javascript, \
                             pre.lang-json, \
                             pre.lang-makefile, \
                             pre.lang-nginxconf, \
                             pre.lang-objectivec, \
                             pre.lang-php, \
                             pre.lang-plaintext, \
                             pre.lang-powershell, \
                             pre.lang-python, \
                             pre.lang-ruby, \
                             pre.lang-swift, \
                             pre.lang-yaml, \
                             pre.lang-xml";
          document.querySelectorAll(selectors).forEach(function(el) {
            hljs.highlightBlock(el);
          });
        });
      </script></body>
</html>
