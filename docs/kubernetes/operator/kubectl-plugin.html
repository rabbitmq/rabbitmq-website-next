<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="73d8ba46-8c12-43f6-8c22-24aa21b8d93d" name="onetrust-data-domain" /><meta content="https://tags.tiqcdn.com/utag/vmware/microsites-privacy/prod/utag.js" name="microsites-utag" /><script src="https://d1fto35gcfffzn.cloudfront.net/assets/jquery-1.11.2.min.js"></script><script src="//www.vmware.com/files/templates/inc/utag_data.js"></script><script src="//tags.tiqcdn.com/utag/vmware/microsites-privacy/prod/utag.sync.js"></script><script>function OptanonWrapper() { { window.dataLayer.push({ event: 'OneTrustGroupsUpdated' }); } }</script><script src="/js/gtm.js"></script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="googlebot" content="NOODP" /><meta name="google-site-verification" content="nSYeDgyKM9mw5CWcZuD0xu7iSWXlJijAlg9rcxVOYf4" /><meta name="google-site-verification" content="6UEaC3SWhpGQvqRnSJIEm2swxXpM5Adn4dxZhFsNdw0" /><meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="viewport" name="viewport" /><link href="https://fonts.googleapis.com/css?family=Raleway:400,500,600,700" rel="stylesheet" /><link rel="stylesheet" href="/css/rabbit.css" type="text/css" /><link rel="stylesheet" href="/css/highlightjs_style.css" type="text/css" /><link rel="stylesheet" href="/css/rabbit-next.css" type="text/css" /><!--[if IE 6]>
      <link rel="stylesheet" href="/css/rabbit-ie6.css" type="text/css" />
      <![endif]--><link rel="icon" type="/image/vnd.microsoft.icon" href="/favicon.ico" /><link rel="stylesheet" href="/css/tutorial.css" type="text/css" /><script async="true" type="text/javascript" src="/js/site.js"></script><title> RabbitMQ Cluster Operator Plugin for kubectl
 — RabbitMQ</title></head>
  <body id="kubernetes/operator/kubectl-plugin"><div id="outerContainer"><div class="container"><div class="rabbit-logo"><a href="/"><img src="/img/logo-rabbitmq.svg" alt="RabbitMQ" /></a></div><a class="btn menubtn" onclick="showHide()">Menu <img src="/img/carrot-down-white.svg" /></a><div class="mobilemenuicon" onclick="showHide()"><img src="/img/mobile-menu-icon.svg" /></div><div id="nav"><ul id="mainNav"><li><a href="/#features">Features</a></li><li><a href="/#getstarted">Get Started</a></li><li><a href="/#support">Support</a></li><li><a href="/#community">Community</a></li><li><a href="/documentation.html">Docs</a></li></ul></div></div><div class="nav-separator"></div><div id="innerContainer" class="container"><div id="left-content"><h1> RabbitMQ Cluster Operator Plugin for kubectl
</h1>
<p>Installing the RabbitMQ Cluster Operator plugin for kubectl makes installing the <a href="./operator-overview.html">RabbitMQ Cluster Kubernetes Operator</a> into any Kubernetes instance easier because each plugin command automates many interactions with the kubernetes API and the RabbitMQ Cluster Operator. The plugin also includes several commands for common workflows with RabbitMQ clusters.</p>
<p>To find out more about using the RabbitMQ Cluster operator and how to deploy Custom Resource objects it manages, refer to the
<a href="./using-operator.html">Using RabbitMQ Cluster Operator</a> information.</p>
<h2>Before Installing the RabbitMQ Cluster Operator Plugin for kubectl</h2>
<p>Ensure you have the following tools installed: </p>
<ul>
<li><a href="https://krew.sigs.k8s.io/docs/user-guide/setup/install/">Krew</a> is the plugin manager for kubectl command-line tool. </li>
<li><a href="https://kubernetes.io/docs/tasks/tools/">kubectl</a></li>
</ul>
<p>After installing <span class="code ">krew</span>, verify the installation:</p>
<pre class="lang-bash">
kubectl krew
</pre>

<h3><a id="install" class="anchor" href="#install">Install the Cluster Operator Plugin for kubectl</a></h3>
<p>When krew is setup, you can now install the RabbitMQ Cluster Operator plugin.</p>
<pre class="lang-bash">
kubectl krew install rabbitmq
</pre>

<p>To verify the plugin is installed, get the list of available commands:</p>
<pre class="lang-bash">
kubectl rabbitmq help
# USAGE:
#   Install RabbitMQ Cluster Operator (optionally provide image to use a relocated image or a specific version)
#     kubectl rabbitmq install-cluster-operator [IMAGE]
# [...]
</pre>

<hr />
<h2><a id="using" class="anchor" href="#using">Using the Cluster Operator Plugin for kubectl</a></h2>
<h3><a id="create-rmq" class="anchor" href="#create-rmq">Create a RabbitMQ Cluster</a></h3>
<pre class="lang-bash">
kubectl rabbitmq create INSTANCE
</pre>

<p>The previous command creates a RabbitMQ cluster with some basic configuration where only the cluster name is configured.</p>
<h3><a id="get-rmq" class="anchor" href="#get-rmq">Get a RabbitMQ Cluster</a></h3>
<pre class="lang-bash">
kubectl rabbitmq get INSTANCE
</pre>

<p>Display all of the kubernetes resources associated with the named RabbitMQ cluster including pods, configmaps, statefulsets, services, and secrets.</p>
<pre class="lang-bash">
NAME                     READY   STATUS    RESTARTS   AGE
pod/hello-rmq-server-0   0/1     Pending   0          5h31m

NAME                               DATA   AGE
configmap/hello-rmq-plugins-conf   1      5h31m
configmap/hello-rmq-server-conf    2      5h31m

NAME                                READY   AGE
statefulset.apps/hello-rmq-server   0/1     5h31m

NAME                      TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)              AGE
service/hello-rmq         ClusterIP   10.100.156.4   none        5672/TCP,15672/TCP   5h31m
service/hello-rmq-nodes   ClusterIP   None           none        4369/TCP,25672/TCP   5h31m

NAME                             TYPE     DATA   AGE
secret/hello-rmq-default-user    Opaque   3      5h31m
secret/hello-rmq-erlang-cookie   Opaque   1      5h31m
</pre>

<h3><a id="list-rmq" class="anchor" href="#list-rmq">List all RabbitMQ Clusters</a></h3>
<pre class="lang-bash">
kubectl rabbitmq list
</pre>

<p>The previous commands lists all RabbitMQ clusters deployed by the RabbitMQ cluster operator on the target kubernetes instance.</p>
<h3><a id="delete-rmq" class="anchor" href="#delete-plugin">Delete a RabbitMQ Cluster</a></h3>
<pre class="lang-bash">
kubectl rabbitmq delete INSTANCE
</pre>

<p>The previous command deletes a RabbitMQ cluster, or multiple RabbitMQ clusters. When deleting multiple RabbitMQ clusters, provide a space
separated list.</p>
<pre class="lang-bash">
kubectl rabbitmq delete rmq1 rmq2 rmq3
</pre>

<h3><a id="secrets" class="anchor" href="#secrets">Print Default User Secrets for the RabbitMQ Cluster</a></h3>
<pre class="lang-bash">
kubectl rabbitmq secrets INSTANCE
</pre>

<p>The previous command lists the default user secrets for the named RabbitMQ cluster.</p>
<h3><a id="manage" class="anchor" href="#manage">Open the RabbitMQ Management UI</a></h3>
<pre class="lang-bash">
kubectl rabbitmq manage INSTANCE
</pre>

<p>The previous command opens the RabbitMQ <a href="../../management.html">Management UI</a> in a browser.</p>
<h3><a id="debug" class="anchor" href="#debug">Set the Log Level on all RabbitMQ Nodes for Debugging</a></h3>
<pre class="lang-bash">
kubectl rabbitmq debug INSTANCE
</pre>

<p>The previous command sets the log level on all nodes to debug. For a detailed breakdown on RabbitMQ logging, refer to the <a href="../../logging.html">Logging</a> information.</p>
<h3><a id="tail" class="anchor" href="#tail">Tail Logs</a></h3>
<pre class="lang-bash">
kubectl rabbitmq tail INSTANCE
</pre>

<p>After running the previous command, you will see all log output for the remote RabbitMQ nodes on your console. Note, to run the previous command, you must have the <span class="code ">tail</span> plugin installed.</p>
<p>Install the <span class="code ">tail</span> plugin by running the following command:</p>
<pre class="lang-bash">
kubectl krew install tail
</pre>

<h3><a id="observe" class="anchor" href="#observe">Observe Nodes on the RabbitMQ Cluster</a></h3>
<pre class="lang-bash">
kubectl rabbitmq observe INSTANCE INDEX
</pre>

<p>The previous command opens the <a href="../../rabbitmq-diagnostics.8.html"><span class="code ">rabbitmq-diagnostics</span></a> observer interface for a given node.</p>
<h3><a id="feature-flags" class="anchor" href="#feature-flags">Turn on All Feature Flags</a></h3>
<pre class="lang-bash">
kubectl rabbitmq enable-all-feature-flags INSTANCE 
</pre>

<p>The previous command uses <a href="../../cli.html"><span class="code ">rabbitmqctl</span></a> to activate or turn on all possible <a href="../../feature-flags.html">feature flags</a>.</p>
<h3><a id="pause-reconciliation" class="anchor" href="#pause-reconciliation">Pause Reconciliation on the RabbitMQ Cluster</a></h3>
<pre class="lang-bash">
kubectl rabbitmq pause-reconciliation INSTANCE 
</pre>

<p>The previous command adds the label "rabbitmq.com/pauseReconciliation=true" to the target RabbitMQ cluster. The label prevents the Operator from watching and updating the instance.</p>
<h3><a id="resume-reconciliation" class="anchor" href="#resume-reconciliation">Resume Reconciliation on the RabbitMQ Cluster</a></h3>
<pre class="lang-bash">
kubectl rabbitmq resume-reconciliation INSTANCE 
</pre>

<p>The previous command instructs the Operator to resume reconciliation for a RabbitMQ cluster.</p>
<h3><a id="list-pause-reconciliation-instances" class="anchor" href="#list-pause-reconciliation-instances">List Instances with Paused Reconciliation</a></h3>
<pre class="lang-bash">
kubectl rabbitmq [list pause reconciliation instances](list-pause-reconciliation-instances) INSTANCE
</pre>

<p>The previous command lists all instances that are not being reconciled by the Operator.</p>
<h3><a id="perf-test" class="anchor" href="#perf-test">Perf Test</a></h3>
<pre class="lang-bash">
kubectl rabbitmq perf-test INSTANCE --rate 100
</pre>

<p>The previous command runs <a href="https://rabbitmq.github.io/rabbitmq-perf-test/stable/htmlsingle/">perf-test</a> against an instance. You can pass as many perf test parameters as you like here.</p>
<p>To monitor PerfTest, add the following ServiceMonitor:</p>
<pre class="lang-yaml">
  apiVersion: monitoring.coreos.com/v1
  kind: ServiceMonitor
  metadata:
    name: kubectl-perf-test
  spec:
    endpoints:
    - interval: 15s
      targetPort: 8080
    selector:
      matchLabels:
        app: perf-test
</pre>

<p>Please submit feedback and feature requests for the RabbitMQ Cluster Operator <a href="https://github.com/rabbitmq/cluster-operator">on GitHub</a>.</p><div id="help-and-feedback"><h2>Getting Help and Providing Feedback</h2><p>
                    If you have questions about the contents of this guide or
                    any other topic related to RabbitMQ, don't hesitate to ask them
                    using <a href="https://github.com/rabbitmq/rabbitmq-server/discussions">GitHub Discussions</a>
                    or our community <a href="https://rabbitmq.com/discord">Discord server</a>.
                  </p></div><div id="contribute"><h2>Help Us Improve the Docs &lt;3</h2><p>
                    If you'd like to contribute an improvement to the site,
                    its source is <a href="https://github.com/rabbitmq/rabbitmq-website">available on GitHub</a>.
                    Simply fork the repository and submit a pull request. Thank you!
                  </p></div></div><div id="right-nav"></div></div><div class="clear"></div><div class="pageFooter"><div class="container"></div><div class="container"><div class="rabbit-logo"><a href="/"><img src="/img/logo-rabbitmq-white.svg" alt="RabbitMQ" /></a></div><ul class="footerNav"><li><a href="/#features">Features</a></li><li><a href="/#getstarted">Get Started</a></li><li><a href="/#support">Support</a></li><li><a href="/#community">Community</a></li><li><a href="/documentation.html">Docs</a></li></ul><p id="copyright">
          Copyright © 2005-2023 <a href="https://tanzu.vmware.com/">Broadcom</a>. All Rights Reserved. The term "Broadcom" refers to Broadcom Inc. and/or its subsidiaries.
          <a href="https://www.vmware.com/help/legal.html">Terms of Use</a> •
          <a href="https://www.vmware.com/help/privacy.html">Privacy</a> •
          <a href="/trademark-guidelines.html">Trademark Guidelines</a> •
          <a href="https://www.vmware.com/help/privacy/california-privacy-rights.html">Your California Privacy Rights</a> •
          <a class="ot-sdk-show-settings">Cookie Settings</a><br /><a id="teconsent"></a></p></div></div></div><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript">
        // code highlighting
        window.addEventListener("load", function() {
          const selectors = "pre.lang-apacheconf, \
                             pre.lang-bash, \
                             pre.lang-csharp, \
                             pre.lang-clojure, \
                             pre.lang-elixir, \
                             pre.lang-erlang, \
                             pre.lang-go, \
                             pre.lang-groovy, \
                             pre.lang-haskell, \
                             pre.lang-ini, \
                             pre.lang-java, \
                             pre.lang-javascript, \
                             pre.lang-json, \
                             pre.lang-makefile, \
                             pre.lang-nginxconf, \
                             pre.lang-objectivec, \
                             pre.lang-php, \
                             pre.lang-plaintext, \
                             pre.lang-powershell, \
                             pre.lang-python, \
                             pre.lang-ruby, \
                             pre.lang-swift, \
                             pre.lang-yaml, \
                             pre.lang-xml";
          document.querySelectorAll(selectors).forEach(function(el) {
            hljs.highlightBlock(el);
          });
        });
      </script></body>
</html>
